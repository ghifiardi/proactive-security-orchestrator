# Orchestrator Files Index

This document maps all files in the Proactive Codebase Testing orchestrator and explains their purpose. **Start here if you're new to this structure.**

---

## ðŸš€ START HERE (Read These First)

### 1. **README.md**
   - **What**: High-level overview of the orchestrator
   - **Length**: ~300 lines
   - **Purpose**: Understand what this is, quick start, CLI examples, troubleshooting
   - **When to read**: First thing (5 min)
   - **Action**: Follow "Quick Start" section

### 2. **IMPLEMENTATION_GUIDE.md**
   - **What**: Step-by-step instructions to use Cursor for Research â†’ Plan â†’ Implement
   - **Length**: ~400 lines
   - **Purpose**: Walk through all three phases, from setup to complete
   - **When to read**: Before opening Cursor (10 min)
   - **Action**: Follow Part 1 (setup) â†’ Part 5 (implementation)

### 3. **INDEX.md** (this file)
   - **What**: Map of all files and their purpose
   - **Purpose**: Understand the structure, find what you need
   - **When to read**: Now (to understand organization)

---

## ðŸ“‚ Directory Structure & Files

### `.agents/` â€“ Workflow Artifacts (Output of Each Phase)

These are **generated** by the workflow. Read them to understand what was decided.

| File | Generated by | Purpose | Read When |
|------|--------------|---------|-----------|
| **research.md** | Phase A (Research) | Investigation findings: scope, file map, execution flow, risks, evidence | After Phase A, before Phase B |
| **plan.md** | Phase B (Plan) | Implementation plan: Langkah 1â€“12, per-file changes, acceptance criteria | After Phase B, before Phase C |
| **progress.md** | Phase C (Implement) | Execution log: Langkah N--Ringkasan (â‰¤20 lines each, step-by-step) | During Phase C, after each Langkah |
| **decisions.md** | Manually edited | Design decisions: "Why we chose X instead of Y" (optional but recommended) | For team alignment |
| **risks.md** | Manually edited | Risk register: identified risks & mitigations (optional) | For risk tracking |

**How to read**: Open in your editor â†’ scroll through â†’ understand the context

**Example**: `cat .agents/research.md | less`

---

### `prompts/` â€“ LLM Prompt Templates (Reusable, Phase-Specific)

These are **templates** you paste into Cursor Composer. They guide the LLM through each phase.

| File | Phase | Purpose | Length | How to Use |
|------|-------|---------|--------|-----------|
| **parent_system_prompt.md** | A, B, C | System prompt for Cursor Composer; defines orchestrator rules & child agents | ~400 lines | **Set as SYSTEM prompt once** â†’ keep for all 3 phases |
| **research_prompt.md** | A (Research) | Instructs LLM to investigate codebase & produce research.md | ~150 lines | Paste in USER box for Phase A |
| **plan_prompt.md** | B (Plan) | Instructs LLM to convert research into implementation plan | ~150 lines | Paste in USER box for Phase B |
| **implement_prompt.md** | C (Implement) | Instructs LLM to execute one Langkah, produce diff + tests | ~200 lines | Paste in USER box for Phase C (per Langkah) |

**How to use**: 
1. Open Cursor Composer
2. Set **SYSTEM** = parent_system_prompt.md (once)
3. Paste appropriate **USER** prompt per phase
4. Run â†’ generates artifacts

**Example flow**:
```
Phase A: System + research_prompt.md â†’ generates research.md
Phase B: System + plan_prompt.md â†’ generates plan.md
Phase C: System + implement_prompt.md (Langkah 1) â†’ diff + progress update
Phase C: System + implement_prompt.md (Langkah 2) â†’ diff + progress update
... repeat for all 12 Langkah
```

---

### `contracts/` â€“ JSON Schemas (Data Validation)

These define the **shape** of data that tools & child agents produce. Enforce consistency.

| File | Purpose | Used By | When |
|------|---------|---------|------|
| **child_agent_schema.json** | JSON schema for findings (tool outputs, child agent responses) | FindingValidator, all child agents | During validation of each finding |

**Schema fields** (required):
```json
{
  "finding": "string",           // Description of finding
  "evidence": [                  // Array of code locations
    {
      "path": "string",          // File path
      "lines": "string",         // Line range (e.g., "L10-L15")
      "why_relevant": "string"   // Why this location matters
    }
  ],
  "confidence": number,          // 0.0â€“1.0
  "tool": "semgrep|gitleaks|orchestrator",
  "severity": "critical|high|medium|low|info"
}
```

**How to use**: 
- When implementing FindingValidator, load this schema
- Validate all findings against it
- Reject non-compliant findings (log & skip)

---

### `.cursorrules` â€“ Workflow Guardrails

This file **enforces** the spec-first workflow in Cursor. Cursor reads it automatically.

| Section | Purpose | Enforces |
|---------|---------|----------|
| **ARTIFACT RULES** | Which file to write during each phase | Only research.md in Phase A, only plan.md in Phase B, etc. |
| **FORMATS (STRICT)** | Exact structure of research.md, plan.md, progress.md | Headers, sections, required fields |
| **CONTEXT HYGIENE** | Keep Composer <40% of window | References only (no pasting full files) |
| **CHILD AGENTS** | Child agents respond in JSON | JSON schema compliance |
| **PULL REQUESTS** | Link PR to artifacts | Use .github/PULL_REQUEST_TEMPLATE.md |

**How to use**: File exists in repo root; Cursor automatically reads it.

---

### `.github/` â€“ GitHub Integration

These files integrate with GitHub Actions & PR workflow.

| File | Purpose | Triggered When |
|------|---------|----------------|
| **PULL_REQUEST_TEMPLATE.md** | PR template linking to .agents/ artifacts | Opening new PR |

**How to use**: GitHub automatically uses this template when you create a PR.

**Template sections**:
- Context (links to research.md Â§, plan.md Â§ Langkah N)
- Ringkasan Perubahan (summary)
- Verifikasi (test results)
- Risiko & Rollback
- Mental Alignment (why this design)

---

### `config/` â€“ Tool Configuration Files

Configuration for Semgrep & Gitleaks (in implementation).

| File | Tool | Purpose | When |
|------|------|---------|------|
| **semgrep/rules.yaml** | Semgrep | Which rules to run, paths to exclude, timeouts | During implementation Langkah 8 |
| **gitleaks/.gitleaksignore** | Gitleaks | Patterns to exclude (reduce false positives) | During implementation Langkah 9 |

**How to use**: 
- Semgrep reads rules.yaml during analyze()
- Gitleaks reads .gitleaksignore during scan()
- Edit these files to customize tool behavior

---

### `src/` â€“ Core Implementation (Generated During Phase C)

These files are **created/modified during implementation**. Start empty; populated by Langkah 1â€“12.

| File | Langkah | Purpose | When |
|------|---------|---------|------|
| `security_orchestrator.py` | 6 | Parent orchestrator (SecurityScanner class) | Langkah 6 |
| `tools/semgrep_analyzer.py` | 3 | Semgrep wrapper | Langkah 3 |
| `tools/gitleaks_scanner.py` | 4 | Gitleaks wrapper | Langkah 4 |
| `formatters/output_formatter.py` | 5 | JSON/SARIF/HTML formatters | Langkah 5 |
| `validators/finding_validator.py` | 2 | JSON schema validator | Langkah 2 |
| `cli.py` | 7 | CLI entry point (Typer) | Langkah 7 |

---

### `tests/` â€“ Test Suite (Generated During Phase C)

Tests for each module. Start empty; populated during implementation.

| File | Tests | Purpose | Run |
|------|-------|---------|-----|
| `test_security_orchestrator.py` | SecurityScanner | Orchestrator logic | `pytest tests/test_security_orchestrator.py -v` |
| `test_semgrep_analyzer.py` | SemgrepAnalyzer | Semgrep wrapper | `pytest tests/test_semgrep_analyzer.py -v` |
| `test_gitleaks_scanner.py` | GitleaksScanner | Gitleaks wrapper | `pytest tests/test_gitleaks_scanner.py -v` |
| `test_finding_validator.py` | FindingValidator | Schema validation | `pytest tests/test_finding_validator.py -v` |
| `test_output_formatter.py` | OutputFormatter | Format conversion | `pytest tests/test_output_formatter.py -v` |
| `test_cli.py` | CLI | CLI interface | `pytest tests/test_cli.py -v` |
| `test_integration.py` | End-to-end | Full orchestrator scan | `pytest tests/test_integration.py -v` |

**How to run all tests**:
```bash
pytest tests/ -v --cov=src --cov-report=html
```

**Expected**: â‰¥80% coverage, all tests pass

---

### Root-Level Files

| File | Purpose |
|------|---------|
| **README.md** | Quick start, CLI usage, troubleshooting, deployment |
| **IMPLEMENTATION_GUIDE.md** | Step-by-step walkthrough (Part 1â€“6) |
| **INDEX.md** | This file |
| **.cursorrules** | Workflow guardrails (read by Cursor) |
| **setup.py** | Package metadata, dependencies (generated during Langkah 1) |
| **requirements.txt** | Pinned dependency versions (generated during Langkah 1) |

---

## ðŸ”„ Workflow Phases & Key Files

### Phase A: RESEARCH (90 min)

**Files used**:
- Read: `prompts/parent_system_prompt.md`, `prompts/research_prompt.md`
- Write: `.agents/research.md`
- Reference: `.cursorrules`

**Output**: `.agents/research.md` with scope, file map, execution flow, risks, evidence

### Phase B: PLAN (120 min)

**Files used**:
- Read: `.agents/research.md`, `prompts/parent_system_prompt.md`, `prompts/plan_prompt.md`
- Write: `.agents/plan.md`
- Reference: `.cursorrules`

**Output**: `.agents/plan.md` with 12 atomic Langkah, each with uji cepat

### Phase C: IMPLEMENT (12 Langkah Ã— 45 min = 9 hours)

**Files used per Langkah**:
- Read: `.agents/plan.md` (Langkah N), `.agents/progress.md` (Langkah N-1)
- Read: `prompts/parent_system_prompt.md`, `prompts/implement_prompt.md`
- Write: `src/`, `tests/`, `config/`, `.agents/progress.md` update
- Reference: `.cursorrules`, `.github/PULL_REQUEST_TEMPLATE.md`

**Output**: Code changes + passing tests + progress update per Langkah

---

## ðŸ“– How to Navigate This Codebase

### If you want to understand **what this is**:
1. Read **README.md** (5 min)
2. Skim **ARCHITECTURE.md** (if exists) for technical details

### If you want to **use this in Cursor**:
1. Read **IMPLEMENTATION_GUIDE.md** (10 min)
2. Follow Part 1 (setup) â†’ Part 2 (Cursor prep) â†’ Part 3 (Phase A)

### If you want to **understand the structure**:
1. Read this file (**INDEX.md**)
2. Read **`.cursorrules`** (5 min) for workflow rules

### If you want to **modify/extend the orchestrator**:
1. Understand Phase A: read `.agents/research.md`
2. Understand Phase B: read `.agents/plan.md`
3. Understand Phase C: read `.agents/progress.md` + relevant Langkah in plan.md
4. Make changes following the spec-first approach

### If you want to **debug a failing Langkah**:
1. Read the failing Langkah in `.agents/plan.md`
2. Check previous Langkah in `.agents/progress.md` for blockers
3. Run the uji cepat command: `pytest tests/test_X.py -v`
4. Debug, fix, then request Directed Restart if scope needs adjustment

---

## ðŸ” Quick Reference: File Cheat Sheet

### Paste into Cursor (Research â†’ Plan â†’ Implement)

```
SYSTEM (set once):
  prompts/parent_system_prompt.md

USER (Phase A):
  prompts/research_prompt.md + target description

USER (Phase B):
  prompts/plan_prompt.md

USER (Phase C, Langkah N):
  prompts/implement_prompt.md + Langkah N from plan.md
```

### Verify Each Phase

```
Phase A done? Check: .agents/research.md exists & is complete
Phase B done? Check: .agents/plan.md exists & has 12 Langkah
Phase C done? Check: .agents/progress.md has 12 entries, all âœ…
```

### Run Tests

```bash
pytest tests/ -v
pytest tests/test_X.py -v
pytest --cov=src --cov-report=html
```

### Run CLI

```bash
python -m proactive_security_orchestrator.cli scan /repo --format json --output findings.json
python -m proactive_security_orchestrator.cli scan /repo --format sarif --output findings.sarif
python -m proactive_security_orchestrator.cli scan /repo --format html --output dashboard.html
```

---

## âœ… Completion Checklist

Use this to track progress:

### Preparation
- [ ] Read README.md
- [ ] Read IMPLEMENTATION_GUIDE.md
- [ ] Understand this INDEX.md
- [ ] Run `pytest tests/ -v` (confirm setup)

### Phase A (Research)
- [ ] Set System prompt in Cursor
- [ ] Run research_prompt.md
- [ ] Review .agents/research.md
- [ ] Get human approval

### Phase B (Plan)
- [ ] Run plan_prompt.md
- [ ] Review .agents/plan.md
- [ ] Confirm 12 Langkah are atomic
- [ ] Get human approval

### Phase C (Implement)
- [ ] Run implement_prompt.md (Langkah 1)
- [ ] Apply diff, run tests
- [ ] Check .agents/progress.md updated
- [ ] Open PR (link to .agents/)
- [ ] Repeat for Langkah 2â€“12

### Post-Implementation
- [ ] All tests pass (â‰¥80% coverage)
- [ ] .agents/progress.md shows "Complete âœ…"
- [ ] Manual testing on real repo
- [ ] Docker build succeeds
- [ ] decisions.md documented

---

## ðŸŽ“ Learning Order

1. **README.md** â€” What is this?
2. **INDEX.md** (this file) â€” How is it organized?
3. **IMPLEMENTATION_GUIDE.md** â€” How do I use it?
4. **prompts/parent_system_prompt.md** â€” What are the rules?
5. **.cursorrules** â€” What does Cursor enforce?
6. **.agents/research.md** (after Phase A) â€” What did we discover?
7. **.agents/plan.md** (after Phase B) â€” What are we building?
8. **.agents/progress.md** (during Phase C) â€” What did we build?

---

## ðŸš€ Next Steps

**Ready to start?**

1. Follow **IMPLEMENTATION_GUIDE.md** Part 1 (setup)
2. Follow **IMPLEMENTATION_GUIDE.md** Part 3 (Phase A in Cursor)
3. Come back here if you get stuck

**Questions?** Check the README.md troubleshooting section.

**Good luck!** ðŸŽ‰

---

**Last updated**: November 14, 2025
**Workflow**: Research â†’ Plan (per-file) â†’ Implement with Parent/Child orchestration
**Test coverage**: â‰¥80% (enforced by pytest)
**Production-ready**: Yes (after all 12 Langkah complete)
